[{
  "Classification": "hdfs-encryption-zones",
  "Properties": {
    "/": "myKey"
  },
  "Configurations": []
}, {
  "Classification": "core-site",
  "Properties": {
    "hadoop.ssl.enabled": "true",
    "hadoop.ssl.hostname.verifier": "DEFAULT",
    "hadoop.ssl.require.client.cert": "false",
    "hadoop.tmp.dir": "/mnt/encrypted/tmp",
    "fs.s3.buffer.dir": "/mnt/encrypted/s3,/mnt1/encrypted/s3",
    "hadoop.ssl.client.conf": "ssl-client.xml",
    "hadoop.ssl.server.conf": "ssl-server.xml",
    "hadoop.ssl.keystores.factory.class": "org.apache.hadoop.security.ssl.FileBasedKeyStoresFactory",
    "hadoop.security.key.provider.path": "kms://http@%{hiera('bigtop::hadoop_head_node')}:%{hiera('hadoop::kms::hadoop_kms_http_port')}/kms",
    "hadoop.rpc.protection": "privacy"

  },
  "Configurations": []
}, {
  "Classification": "mapred-site",
  "Properties": {
    "mapreduce.shuffle.ssl.enabled": "true",
    "mapred.local.dir": "/mnt/encrypted/mapred,/mnt1/encrypted/mapred",
    "mapreduce.cluster.local.dir": "/mnt/encrypted/mapred,/mnt1/encrypted/mapred",
    "mapreduce.application.classpath": "$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/*,\n         $HADOOP_MAPRED_HOME/share/hadoop/mapreduce/lib/*,\n         /usr/lib/hadoop-lzo/lib/*,\n         /usr/share/aws/emr/emrfs/conf,\n         /usr/share/aws/emr/emrfs/lib/*,\n         /usr/share/aws/emr/emrfs/auxlib/*,\n         /usr/share/aws/emr/lib/*,\n         /usr/share/aws/emr/ddb/lib/emr-ddb-hadoop.jar,\n         /usr/share/aws/emr/goodies/lib/emr-hadoop-goodies.jar,\n         /usr/share/aws/emr/kinesis/lib/emr-kinesis-hadoop.jar,\n         /usr/share/aws/emr/cloudwatch-sink/lib/*,\n         /etc/emr/security/conf"
  },
  "Configurations": []
}, {
  "Classification": "spark-env",
  "Properties": {
    "spark.authenticate.enableSaslEncryption": "true",
    "spark.network.sasl.serverAlwaysEncrypt": "true"
  },
  "Configurations": []
}, {
  "Classification": "hdfs-site",
  "Properties": {
    "dfs.encryption.key.provider.uri": "kms://http@%{hiera('bigtop::hadoop_head_node')}:%{hiera('hadoop::kms::hadoop_kms_http_port')}/kms",
    "dfs.namenode.name.dir": "file:///mnt/encrypted/namenode,file:///mnt1/encrypted/namenode",
    "dfs.name.dir": "/mnt/encrypted/namenode,/mnt1/encrypted/namenode",
    "dfs.data.dir": "/mnt/encrypted/hdfs,/mnt1/encrypted/hdfs",
    "dfs.datanode.data.dir": "file:///mnt/encrypted/hdfs,file:///mnt1/encrypted/hdfs"
  },
  "Configurations": []
}, {
  "Classification": "yarn-site",
  "Properties": {
    "yarn.nodemanager.local-dirs": "/mnt/encrypted/yarn,/mnt1/encrypted/yarn",
    "yarn.application.classpath": "$HADOOP_CONF_DIR,\n        $HADOOP_COMMON_HOME/*,\n        $HADOOP_COMMON_HOME/lib/*,\n        $HADOOP_HDFS_HOME/*,\n        $HADOOP_HDFS_HOME/lib/*,\n        $HADOOP_MAPRED_HOME/*,\n        $HADOOP_MAPRED_HOME/lib/*,\n        $HADOOP_YARN_HOME/*,\n        $HADOOP_YARN_HOME/lib/*,\n        /usr/lib/hadoop-lzo/lib/*,\n        /usr/share/aws/emr/emrfs/conf,\n        /usr/share/aws/emr/emrfs/lib/*,\n        /usr/share/aws/emr/emrfs/auxlib/*,\n        /usr/share/aws/emr/lib/*,\n        /usr/share/aws/emr/ddb/lib/emr-ddb-hadoop.jar,\n        /usr/share/aws/emr/goodies/lib/emr-hadoop-goodies.jar,\n        /usr/share/aws/emr/kinesis/lib/emr-kinesis-hadoop.jar,\n        /usr/lib/spark/yarn/lib/datanucleus-api-jdo.jar,\n        /usr/lib/spark/yarn/lib/datanucleus-core.jar,\n        /usr/lib/spark/yarn/lib/datanucleus-rdbms.jar,\n        /usr/share/aws/emr/cloudwatch-sink/lib/*,\n        /etc/emr/security/conf"
  },
  "Configurations": []
}, {
  "Classification": "hadoop-env",
  "Properties": {},
  "Configurations": [{
    "Classification": "export",
    "Properties": {
      "HADOOP_CLASSPATH": "${HADOOP_CLASSPATH}:/etc/emr/security/conf"
    },
    "Configurations": []
  }]
}, {
  "Classification": "emrfs-site",
  "Properties": {
    "fs.s3.cse.kms.keyId": "{{ emr_kms_key_arn }}",
    "fs.s3.cse.enabled": "true",
    "fs.s3.cse.encryptionMaterialsProvider": "com.amazon.ws.emr.hadoop.fs.cse.KMSEncryptionMaterialsProvider"
  },
  "Configurations": []
}]
